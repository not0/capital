---
import fs from "fs";
import path from "path";
const { comicId, episodeNumber } = Astro.props as {
  comicId: string;
  episodeNumber?: string;
};
const base = import.meta.env.BASE_URL;

const pagesPath = episodeNumber
  ? `/assets/comics/${comicId}/episodes/${episodeNumber}/pages`
  : `/assets/comics/${comicId}/pages`;

const pagesDir = path.resolve(`./public${pagesPath}`);
let pages: string[] = [];
try {
  pages = fs.readdirSync(pagesDir).sort();
} catch (err) {
  console.error(`Error reading images for comic ID ${comicId}:`, err);
}
---

<section class="section" style="padding-top: 0;">
  <div class="container" style="max-width: 800px; margin: auto;">
    {
      pages.map((name: string) => (
        <img
          src={`${base}/${pagesPath}/${name}`}
          alt={name}
          loading="lazy"
          style="width: 100%; margin-bottom: 3rem;"
        />
      ))
    }
  </div>
</section>
